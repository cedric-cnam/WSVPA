% !TEX root = main.tex
%

\subsection*{(Alternative Algorithm for best-search)}
We shall compute the values of the functions $b_\bot$ and $b_\top$
by searching shortests paths in a $\Semiring$-labeled graph $\G_A$
associated to the \SWVPA $A$. 
This graph is defined by $\G_A = \< V_A, E_A, \eta_A >$, 
with set of vertices $V_A = (Q \times Q) \cup (Q \times P \times Q)$,
set of edges $E_A = V_A \times V_A$
(an edge $\< v_1, v_2>$, with $v_1, v_2 \in V_A$ is denoted by $v_1 \to v_2$),
and with an edge labelling  
$\eta_A : E_A \to \Semiring$ defined as follows,
for $q_0, q_1, q_2, q_3 \in Q$, $p, p' \in P$:
%
\[
\begin{array}{rclcl}
\< q_0, q_1> & \to & \< q_0, q_2> & : &
\bigoplus_{\Deltai} \weiei(q_1, q_2)\\
%
\< q_1, p, q_2> & \to & \<q_0, q_3> & : &
\bigoplus_{\Deltac} \bigl( \weiec(q_0, p, q_1) \otimes \bigoplus^2_{\Deltar} \weir(q_2, p, q_3)\bigr)\\ 
%
\< q_0, q_2> & \to & \< q_0, q_3> & : & 
\bigoplus_{\Deltar} \weier(q_2, q_3)\\
% 
\< q_0, p, q_1> & \to & \< q_0, p, q_2> & : &
\bigoplus_{\Deltai} \weii(q_1, p, q_2)\\[1mm]
%
\< q_1, p', q_2> & \to & \< q_0, p, q_3> & : &
\bigoplus^2_{\Deltac} \bigl[ \weic(q_0, p, p', q_1) \otimes_2 {\bigoplus_{\Deltar}} \weir(q_2, p', q_3) \bigr]\\
\end{array}
\]
Removing from $\G_A$ every edge $e \in E_A$ such that $\eta(e) = \zero$ 
is preserving the results below.
%
A \emph{path} of $\G_A$ is a sequence $v_0,\ldots, v_n \in V^*_A$,
%for all $0 \leq i < n$. %the second component of $e_i$ is the first component of $e_{i+1}$.
%We write $\src(\pi) = e_1$ and $\trg(\pi) = e_n$.
it is assigned a weight value $\weight(\pi) = \bigotimes_{i=1}^{n} \eta(v_{i-1} \to v_i)$.

%Intuitively, 
\begin{lemma}[Correctness]
For all $q_0, q_1, q_2 \in Q$, $p\in P$, 
and all path $\pi$ of $\G_A$ with $\src(\pi) = \<q_0, q_0>$,
($i$) if $\trg(\pi) = \< q_1, q_2>$, 
then there exists $u \in \Delta^*$ such that 
$\weight_A(q_1[\bot], u, q_1[\bot]) = \weight(\pi)$,
%
($ii$) if $\trg(\pi) = \< q_1, p, q_2>$,
then there exists $v \in \Delta^*$ such that 
${\displaystyle\bigoplus_{c \in \Deltac}}
 \weight_A\bigl(\configup{q_1}{\< c, p> \stackup \top }, v, \configup{q_2}{\<c, p> \stackup \top}\bigr)
 = \weight(\pi)$.
\end{lemma}
%
\begin{proof}
We prove ($i$) and ($ii$) simultaneously by induction on the length of the path $\pi$.
...\qed
\end{proof}



\begin{lemma}[Completeness]
For all $q_1, q_2 \in Q$, $p\in P$, 
($i$) there exists a path $\pi$ of $\G_A$ 
such that $\src(\pi) = \<q_0, q_0>$ for some $q_0 \in Q$, 
$\trg(\pi) = \< q_1, q_2>$,
and $\weight(\pi) = b_\bot(q_1, q_2)$, 
($ii$) there exists a path $\pi'$ of $\G_A$ 
such that $\src(\pi) = \<q_0, q_0>$ for some $q_0 \in Q$, 
$\trg(\pi) = \< q_1, p, q_2>$,
and $\weight(\pi) = b_\top(q_1, q_2)$.
\end{lemma}
%
\begin{proof}
By~\eqref{eq:bbot}, 
and since $\Semiring$ is total, for all $q_1, q_2 \in Q$, 
there exists one or several $t \in \Delta^*$ such that  
$b_\bot(q_1, q_2) = \weight_A\bigl(\config{q_1}{\bot}, t, \config{q_2}{\bot}\bigr)$.
Let $T(q_1, q_2) \subseteq \Delta^*$ denotes the set of such words $t$. % of minimal length.
%
Moreover, following~\eqref{eq:SWVPA-weight}, and by distributivity and commutativity in $\Semiring$, 
$b_\bot(q_1, q_2)$ is equal to a finite product $\bigotimes_{i=0}^n w_i(\tau_i)$, 
where every $\tau_i$ is a transition of $A$, every $w_i$ is one of the functions of $\bar\wei$,
the sequence of input symbols in $\tau_0,\ldots, \tau_n$ belongs to $T(q_1, q_2)$, 
$\src(\tau_0) = q_1$, and $\snd(\tau_n) = q_2$, where 
$\src(\tau)$ (resp. $\snd(\tau)$) is the first (resp. second) state component of a transition~$\tau$.
There may be several such sequences of $\tau_i$ and $w_i$, we choose an arbitrarily one of minimal length $n$.

%We represent a computation of $A$ on $t$ by a sequence $\rho$ of its transitions, 

We show now the existence of a path $\pi$ as expected, by induction on $n$.
%that we can construct a path $\pi$ of weight $b_\bot(q_1, q_2)$
%from $\tau_0,\ldots, \tau_n$ and $w_0,\ldots, w_n$. ...\qed
\end{proof}




